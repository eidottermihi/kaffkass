<% @title = "Kaffeerunde anzeigen" %>

<h2>Details zur Kaffeerunde</h2>

<p>Location: <%= @coffee_box.location %></p>
<p>Uhrzeit: <%= @coffee_box.time %></p>
<p>Beschreibung: <%= @coffee_box.description %></p>
<p>Ersteller: <%= @coffee_box.admin.email %></p>
<%= link_to "Konsum bearbeiten", coffee_box_consumptions_path(@coffee_box)%>
<% if @coffee_box.get_consumption_model(current_user) %>
    <%= link_to "Zum hinterlegten Konsummodell", coffee_box_model_of_consumption_path(@coffee_box, @coffee_box.get_consumption_model(current_user)) %>
<% else %>
    <%= link_to "Konsummodell hinterlegen", new_coffee_box_model_of_consumption_path(@coffee_box) %>
<% end %>
<%= link_to "Ausgaben verwalten", coffee_box_expenses_path(@coffee_box) %>
<%= link_to "Zurück zur Liste", coffee_boxes_path %>
<br/>
<hr/>
<h2>Statistiken</h2>

<script type="text/javascript" charset="utf-8">
  $(function() {
    new Highcharts.Chart({
        chart: {
            renderTo: "coffee_price_chart"
        },
        title: {
            text: "Tassenpreis"
        },
        xAxis: {
            type: "datetime"
        },
        yAxis: {
            title: {
                text: "Euro"
            }
        },
        tooltip: {
            formatter: function(){
                return Highcharts.dateFormat("%e %b %Y", this.x) + ": <b>" +
                        Highcharts.numberFormat(this.y, 2)+ "</b> €";
            }
        },
        series: [{
            name: "Tassenpreis",
            pointInterval: <%= 1.month * 1000 %>,
            pointStart : <%= @coffee_box.created_at.to_i * 1000 %>,
            data: <%= @coffee_box.get_cup_price_data.inspect %>
        }]

    })
  });
</script>
<div id="coffee_price_chart" style="width: 560px; height: 300px;"></div>
